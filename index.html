<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ouvidoria</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"  crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="footer.css">

   <!-- Bootstrap CSS -->
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" integrity="sha384-dpuaG1suU0eT09tx5plTaGMLBsfDLzUCCUXOY2j/LSvXYuG6Bqs43ALlhIqAJVRb" crossorigin="anonymous">
   <style>
       /* Estilo para ajustar a altura das imagens */
       .carousel-item img {
           max-height: 600px; /* Defina a altura desejada */
           width: 100%; /* Largura total da tela */
           margin: 0 auto; /* Centraliza a imagem horizontalmente */
       }


       /* Estilo para ajustar a largura do carrossel */
       #carouselExampleIndicators {
           width: 100%; /* Largura total da tela */
           overflow: hidden; /* Oculta qualquer conteúdo extra que ultrapasse a largura definida */
       }

       /* Estilo para centralizar os elementos do formulário */
       #form-container {
           display: none;
           margin: 0 auto;
           max-width: 600px; /* Defina a largura máxima desejada para o formulário */
           border-radius: 15px; /* Cantos arredondados */
           padding: 20px;
           box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Sombra */
           margin-bottom: 30px; /* Margem inferior */
       }
       .form-label {
           text-align: left !important;
       }

       /* Estilo para ocultar o botão de início quando o formulário é exibido */
       .zero-point {
           display: none;
       }


       /* Estilo para centralizar o carregamento */
       .loading {
           text-align: center;
           margin-top: 50px;
       }

       /* Estilo para a barra de progresso */
       .progress-stacked {
           margin-top: 20px;
       }

       /* Estilo para centralizar botões de continuar */
       .step button {
           margin: 0 auto;
           display: block;
       }

       /* Estilo para as linhas finas e transparentes */
       .separator {
           border-top: 1px solid rgba(0, 0, 0, 0.1);
           margin: 30px 0;
       }

       /* Estilo para os cards */
       .card {
           margin-bottom: 20px; /* Margem inferior */
       }

       /* Estilo para a visualização das imagens anexadas */
       #preview img {
         max-width: 100px; /* Defina o tamanho máximo da imagem */
         margin-right: 20px; /* Adicione um espaçamento entre as imagens */
       }

       /* Estilo para animação do botão */
       .pulse {
           animation: pulse 1.5s infinite;
       }

       .forms {
         text-align: left;
         margin-left: 10px;
       }
       
       .left-align {
       text-align: left !important;
       }


       @keyframes pulse {
           0% {
               transform: scale(1);
           }
           50% {
               transform: scale(1.05);
           }
           100% {
               transform: scale(1);
           }
       }
   </style>
   <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
</head>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>


<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top">
        <div class="container-fluid align-items-center">
            <a class="navbar-brand" href="#">
                <img src="assets/logo, Ouvidoria.png" alt="Ícone" width="50" height="50" class="d-inline-block align-top" class="padding: 5px">
                <a>&nbsp;OUVIDORIA</a>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNavDropdown">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="#">Página principal</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="loginempresa.html">Empresas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#reclamacoes-recentes">Reclamações recentes</a>
                    </li>
                    <li class="nav-item dropdown" id="login-dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            Menu
                        </a>
                        <ul class="dropdown-menu">
                            <li id="login-registro"><a class="dropdown-item" href="login.html">Login/registro</a></li>
                            <li id="minhas-reclamacoes" style="display:none;"><a class="dropdown-item" href="telaInicialCliente.html">Minhas Reclamações</a></li>
                            <li id="editar-perfil" style="display:none;"><a class="dropdown-item" href="editarperfil.html">Editar perfil</a></li>
                            <li id="sair" style="display:none;"><a class="dropdown-item"  onclick="logout()">Sair</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    <div id="carouselExampleIndicators" class="carousel slide">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="assets/SUA VOZ.png" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="assets/clientes.png" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="assets/golpes.png" class="d-block w-100" alt="...">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
<br>
    <h1 class="text-center">Faça sua reclamação!</h1>
    <h4 class="text-center">Em apenas três passos</h4>
    <br>
    <!-- Carregamento -->
<div id="loading" class="loading" style="display: none;">
  <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Carregando...</span>
  </div>
</div>

<!-- Ponto Zero: Botão para começar -->
<div class="zero-point text-center" style="display: block;">
  <button type="button" class="btn btn-outline-success pulse" onclick="startForm()">Aperte para começar!</button>
</div>

        </div>
      </div>

       
                </div>
            </div>
        </div>
    </div>
<br>
 <!-- Linha separadora -->
 <div class="separator"></div>
 <br>
 <div class="container text-center">
     <div class="col">
         <h1 id="reclamacoes-recentes">Reclamações recentes</h1>
         <br>
         <div class="input-group mb-3">
             <input type="text" id="search-input" class="form-control" placeholder="Digite o nome da empresa">
             <button class="btn btn-outline-secondary" type="button" id="search-button">
                 <i class="bi bi-search"></i>
             </button>
         </div>

         <!-- Resultados da pesquisa -->
         <div id="search-results" class="row">
             <!-- Os resultados da pesquisa serão exibidos aqui -->
         </div>
     </div>
 </div>
 <br>
 <div class="container">
     <div class="row row-cols-1 row-cols-md-2 g-4" id="reclamacoes-container">
         <!-- Reclamações serão carregadas aqui -->
     </div>
 </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"  crossorigin="anonymous"></script>

     <!-- Bootstrap JavaScript -->
     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"  crossorigin="anonymous"></script>

     
    <script>
    
   
    function startForm() {
        // Ocultar o botão "Aperte para começar"
        var zeroPoint = document.querySelector('.zero-point');
        zeroPoint.style.display = "none";

        // Mostrar o carregamento
        var loading = document.getElementById("loading");
        loading.style.display = "block";

        // Aguardar 3 segundos antes de mostrar o formulário
        setTimeout(function () {
            // Esconder o carregamento
            loading.style.display = "none";
            // ir para a pagina
            window.location.href = 'telareclamacao.html';
        }, 2000);
    }
        
       // Função para carregar as reclamações
function loadReclamacoes() {
    $.ajax({
        url: 'backend/reclamacao.php', // Arquivo PHP que retorna os dados das reclamações
        type: 'GET',
        dataType: 'json',
        success: function(data) {
            var container = $('#reclamacoes-container');
            container.empty(); // Limpa o conteúdo atual do contêiner

            if (data.length > 0) {
                // Itera sobre os dados das reclamações e cria os cards dinamicamente
                data.forEach(function(reclamacao) {
                    var card = `<div class="col">
                                    <div class="card">
                                        <img src="caminho/para/imagem.jpg" class="card-img-top" alt="...">
                                        <div class="card-body">
                                            <h5 class="card-title">${reclamacao.empresa}</h5>
                                            <p class="card-text">${reclamacao.usuario_nome}</p>
                                            <p class="card-text">${reclamacao.descricao}</p>
                                        </div>
                                    </div>
                                </div>`;
                    container.append(card); // Adiciona o card ao contêiner
                });
            } else {
                // Se não houver reclamações, exibe uma mensagem
                container.append('<p>Nenhuma reclamação encontrada.</p>');
            }
        },
        error: function(xhr, status, error) {
            console.error('Erro:', error);
            $('#reclamacoes-container').append('<p>Erro ao carregar reclamações.</p>');
        }
    });
}

// Chama a função para carregar as reclamações ao carregar a página
$(document).ready(function() {
    loadReclamacoes();
});
// Evento de clique no botão de pesquisa
document.getElementById("search-button").addEventListener("click", function() {
    // Obter o valor inserido pelo usuário na barra de pesquisa
    var searchTerm = document.getElementById("search-input").value;
    
    // Fazer solicitação AJAX para buscar reclamações da empresa X
    $.ajax({
        url: 'backend/reclamacao.php',
        type: 'GET',
        data: { empresa: searchTerm }, // Enviar o termo de pesquisa para o backend
        dataType: 'json',
        success: function(data) {
            // Limpar os resultados anteriores
            var searchResults = document.getElementById("search-results");
            searchResults.innerHTML = "";
            
            // Verificar se há resultados da pesquisa
            if (data.length > 0) {
                // Iterar sobre os resultados e criar elementos HTML para exibição
                data.forEach(function(reclamacao) {
                    var card = `<div class="col">
                                    <div class="card">
                                        <div class="card-body">
                                            <h5 class="card-title">${reclamacao.empresa}</h5>
                                            <p class="card-text">${reclamacao.usuario_nome}</p>
                                            <p class="card-text">${reclamacao.descricao}</p>
                                        </div>
                                    </div>
                                </div>`;
                    searchResults.insertAdjacentHTML('beforeend', card); // Adicionar o card aos resultados da pesquisa
                });
            } else {
                // Caso não haja resultados, exibir uma mensagem indicando que não foram encontradas reclamações
                searchResults.innerHTML = "<p>Nenhuma reclamação encontrada para '" + searchTerm + "'.</p>";
            }
        },
        error: function(xhr, status, error) {
            console.error('Erro:', error);
            // Em caso de erro na solicitação AJAX, exibir uma mensagem de erro
            document.getElementById("search-results").innerHTML = "<p>Erro ao buscar reclamações.</p>";
        }
    });
});
window.onload = function() {
    // Verificar se há um ID de usuário armazenado no localStorage
    var userId = localStorage.getItem('user_id');
    if (userId) {
         // Esconder opção de "Login/registro" se o usuário estiver logado
         var loginRegistro = document.getElementById('login-registro');
        if (loginRegistro) {
            loginRegistro.style.display = 'none';
        }
        
        // Mostrar opções de "Minhas Reclamações", "Editar perfil" e "Sair"
        document.getElementById('minhas-reclamacoes').style.display = 'block';
        document.getElementById('editar-perfil').style.display = 'block';
        document.getElementById('sair').style.display = 'block';

        // Usar o ID do usuário conforme necessário, por exemplo:
        console.log("ID do usuário: pagina index" + userId);
    } else {
        console.log("Nenhum ID de usuário encontrado.");
    }
};
// Função para limpar o ID do usuário do localStorage e mostrar a opção de login
function logout() {
    // Remover o ID do usuário do localStorage
    localStorage.removeItem('user_id');
    
    // Redirecionar para a página de login (opcional)
    window.location.href = 'index.html';
    
    // Mostrar opção de "Login/registro"
    var loginRegistro = document.getElementById('login-registro');
    if (loginRegistro) {
        loginRegistro.style.display = 'block';
    }
    // Esconder opções de "Minhas Reclamações", "Editar perfil" e "Sair"
    document.getElementById('minhas-reclamacoes').style.display = 'none';
    document.getElementById('editar-perfil').style.display = 'none';
    document.getElementById('sair').style.display = 'none';
}

// Adicionar evento de clique ao elemento "Sair" para chamar a função de logout
document.getElementById('sair').addEventListener('click', function() {
    logout();
});

  </script>
  <footer class="footer">
    <div class="container">
        <div class="footer-content">
            <div class="footer-logo">
                <img src="assets/logo, Ouvidoria.png" alt="Logo">
            </div>
            <div class="footer-links">
                <ul>
                    <li><a href="#">Página Principal</a></li>
                    <li><a href="#">Empresas</a></li>
                    <li><a href="#">Login</a></li>
                    <li><a href="mailto:ouvidoria@gmail.com">ouvidoria@gmail.com</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>

 </body>
 
 </html>